# controller

`controller`服务作为和设备进行信息交互时的控制节点，为访问设备提供路由服务，并接收设备上报的信息。

## 工作原理
`controller`主要负责设备信息交互，具体分两种场景：

* 当应用需要向设备发送信息时，`controller`会向`devicemanager` 查询当前设备的在线信息，并根据反馈的接入点，向接入服务器发送信息转发请求。
* 当设备向平台发送数据时，`controller`会将数据存入MongoDB，如需通知应用则放入消息队列。

## 启动参数
* `-etcd` etcd服务的访问地址，必需参数。如`http://localhost:2379`,如果etcd是多副本部署，可以用分号隔开访问地址，如`http://192.168.0.2:2379;http://192.168.0.3:2379`。
* `-rpchost` rpc服务访问地址，必需参数。该参数定义该服务对其他服务提供的rpc服务的监听地址。如`http://localhost:20034`。
* `-mongohost` MongoDB地址，可选参数。如果没有提供则为`localhost`,如果需要指定，格式为`ip:port`如`192.168.0.3:27017`。
* `-loglevel` 服务打印日志的级别，选填，如果没有指定则默认为`info`级别。